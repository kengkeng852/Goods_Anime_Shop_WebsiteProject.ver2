<!--
    Noted that:
    INSERT Router was in routes: products.js
    UPDATE AND DELETE was in index.js
    because delete and update has in the detail page (views/p_detail.ejs)
    *****product. xx from  res.render('product', { product: results }); products.js *****
-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Management</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">


    <link rel="stylesheet" href="https://kit.fontawesome.com/6c12e1ae8d.css" crossorigin="anonymous">
    <link rel="stylesheet" href="/css/hpstyle.css">
    <link rel="stylesheet" href="/css/search.css">
    <link rel="stylesheet" href="/stylesheets/form_popup.css">

    <!-- font poppins -->
	<link href='https://fonts.googleapis.com/css?family=Poppins' rel='stylesheet'>
    <link href="http://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- icon -->
    <link href="https://cdn.jsdelivr.net/npm/remixicon@2.5.0/fonts/remixicon.css" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/boxicons@latest/css/boxicons.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
    <!-- js -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <script type="text/javascript" src="api.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/boxicons@latest/css/boxicons.min.css">
    <script src="/html/api.js"></script>

</head>
<body>
    <!-- header section starts  -->
    <header>
        <a href="/html/index.html" class="logo">Goods Days <span>.</span></a>

        <nav class="navbar">
            <a href="/html/index.html">home</a>
            <a href="/html/aboutus.html">about</a>
            <a href="/search">search</a>
            <a href="/html/contactus.html">contact</a>
        </nav>

        <div class="icons">
            <a href="/html/login.html" class="fa fa-user"></a>
        </div>
    </header>
    <!-- header section end -->

    <!-- main section starts  -->
    <main>
        <section class="products" id="products">
            <div class="container">
                <form method="POST" action="/products/search">
                    <div class="search-bar">
                        <div id="select">
                            <div class="dropdown-container">
                                <label for="anime">Anime:</label>
                                <select id="anime" name="anime">
                                    <option value="">Select Anime</option>
                                    <option value="One Piece">One Piece</option>
                                    <option value="Gundam">Gundam</option>
                                    <option value="Attack On Titan">Attack On Titan</option>
                                </select>
                            </div>
                            <div class="dropdown-container">
                                <label for="type">Type:</label>
                                <select id="type" name="type">
                                    <option value="">Select Type</option>
                                    <option value="Gunpla">Gunpla</option>
                                    <option value="Stand">Stand</option>
                                    <option value="Doll">Doll</option>
                                    <option value="Figure">Figure</option>
                                    <option value="Shoes">Shoes</option>
                                </select>
                            </div>
                            <div class="dropdown-container">
                                <label for="brand">Brand:</label>
                                <select id="brand" name="brand">
                                    <option value="">Select Brand</option>
                                    <option value="BANDAI">BANDAI</option>
                                    <option value="Shueisha">Shueisha</option>
                                    <option value="TakaraTomy Arts">TakaraTomy Arts</option>
                                    <option value="GOOD SMILE COMPANY">GOOD SMILE COMPANY</option>
                                    <option value="Mayla Classic">Mayla Classic</option>
                                </select>
                            </div>
                        </div>
                        <input type="text" id="inputfield" name="searchTerm" placeholder="Search by All Categories">
                        <button type="submit" class="button" >
                            <i class="fa fa-search fa-lg"></i>

                        </button>
                    </div>
                </form>
            </div>
            
            <!--INSERT section start-->
            <div class="cen">
                <div class="row align-items-center">
                      <div class="header-text mb-4">
                        <h2>Insert Product</h2>
                      </div>
                      <!--INSERT form start-->
                      <form>
                        <div class="input-group mb-3">
                          <input type="text" id="pid" placeholder="Enter Product ID" name="pid" class="form-control form-control-lg bg-light fs-5" required><br><br>
                        </div>
                        <div class="input-group mb-3">
                            <input type="text" id="pname" placeholder="Enter Product Name" name="pname" class="form-control form-control-lg bg-light fs-5" required><br><br>
                        </div>
                        <div class="input-group mb-3">
                            <input type="text" id="pprice" placeholder="Enter Product Price" name="pprice" class="form-control form-control-lg bg-light fs-5" required><br><br>
                        </div>
                        <div class="input-group mb-3">
                            <input type="text" id="pquantity" placeholder="Enter Product Quantity" name="pquantity" class="form-control form-control-lg bg-light fs-5" required><br><br>
                        </div>
                        <div class="input-group mb-3">
                            <input type="text" id="pcate" placeholder="Enter Product Category" name="pcate" class="form-control form-control-lg bg-light fs-5" required><br><br>
                        </div>
                        <div class="input-group mb-3">
                            <input type="text" id="panimename" placeholder="Enter Product Anime Name" name="panimename" class="form-control form-control-lg bg-light fs-5" required><br><br>
                        </div>
                        <div class="input-group mb-3">
                            <input type="text" id="pbrand" placeholder="Enter Product Brand" name="pbrand" class="form-control form-control-lg bg-light fs-5" required><br><br>
                        </div>
                        <div class="input-group mb-3">
                            <input type="text" id="pdate" placeholder="Enter Product Release Date" name="pdate" class="form-control form-control-lg bg-light fs-5" required><br><br>
                        </div>
                        <div class="input-group mb-3">
                            <input type="text" id="pimagelink" placeholder="Enter Product Image Link" name="pimagelink" class="form-control form-control-lg bg-light fs-5" required><br><br>
                        </div>
                        <div class="input-group mb-3">
                            <input type="text" id="pwebbuy" placeholder="Enter Product Web For Purchasing" name="pwebbuy" class="form-control form-control-lg bg-light fs-5" required><br><br>
                        </div>
                        <div class="input-group mb-3">
                            <input type="text" id="porigin" placeholder="Enter Product Origin" name="porigin" class="form-control form-control-lg bg-light fs-5" required><br><br>
                        </div>
                        <div class="input-group mb-3">
                            <input type="text" id="pinfo" placeholder="Enter Product Information" name="pinfo" class="form-control form-control-lg bg-light fs-5" required><br><br>
                        </div>
                        
                        <!--INSERT button, directly go to http://localhost:3000/products/add in routes product.js-->
                        <div class="row">
                          <button type="submit" formaction="/products/add" formmethod="POST" class="colorbutton">Add Product</button><br><br>
                        </div>
                      </form>  
                      <!--INSERT form end-->
                    </div>
            </div>
            <!--INSERT section end-->

            <div class="bgproduct">
                <h1 class="headpd"> Products Management</h1>
                <div class="box-container">
                    <% data.forEach((product) => { %>
                        <div class="box">
                            <div class="image">
                                <img src="<%= product.image_url %>" alt="<%= product.name %>">
                                <div class="icons">
                                    <a href="/products/<%= product.Proid %>" class="cart-btn">detail</a>
        

                                </div>
                            </div>
                            <div class="content">
                                <h3><%= product.name %></h3>
                                <div class="price"><%= product.price %> ¥</div>
                            </div>
                        </div>
                    <% }); %>
                </div>
            </div>
        </section>
    </main>
    <!-- main section end  -->


    <footer>
        <div class="box-container">
            <div class="box">
                <h3>About Goods Days</h3>
                <a href="/html/index.html">Home</a>
                <a href="/html/aboutus.html">About</a>
                <a href="/search">Search</a>
                <a href="/html/login.html">Log-in</a>
                <a href="/html/signup.html">Sign-up</a>
                <a href="/html/contactus.html">Contact Us</a>
            </div>

            <div class="box">
                <h3 class="fa fa-user-secret"></h3>
                <a href="/">Admin Management</a>
            </div>

            <div class="box">

                <script> 
                    // His function is triggered when the search button is clicked, and it retrieves data from the Anime News Network API
                    function getConferenceResponses() {
                        let query = document.querySelector("#q").value; // Get query from a textbox
                        console.log(query);
                        let rooturl = "https://cdn.animenewsnetwork.com/encyclopedia/api.xml?title=~" + query; //Request URL
                        fetch(rooturl)
                            .then(res => res.text()) // Get JSON from the response
                            // .then(str => new window.DOMParser().parseFromString(str, "text/xml"))
                            .then((data) => {
                                //console.log(data)
                                let objson = xml2json.fromStr(data);
                                console.log(objson);
                                for (let i = 0; i < objson.ann.anime.length; i++) {
                                    let title = objson.ann.anime[i]['@attributes'].name;
                                    let precision = objson.ann.anime[i]['@attributes'].precision;

                                    document.querySelector("#output").innerHTML += "<p>Name : " + title + "</p>" + "<p>Precision :" + precision + "</p><br>";
                                }
                            })
                            .catch((err) => console.log(err));
                    }
                </script>

                <h2>News Anime</h2>
                <input type="text" placeholder="anime" id="q">
        
                <button onclick="getConferenceResponses()"><i class="ri-search-line"></i></button>
        
                <p>Anime</p>
                <div id="output"></div>

            </div>
        </div>
    </footer>

    <script>
        function openForm(a) {
          document.getElementById("popupForm"+a).style.display = "block";
        }
        function closeForm(a) {
          document.getElementById("popupForm"+a).style.display = "none";
        }
    </script>

</body>
</html>

