<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Admin Account Management</title>

        <!-- font awesome cdn link  -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"> 
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

        <!-- custom css file link  -->
        <link rel="stylesheet" href="/css/hpstyle.css">
        <link rel="stylesheet" href="/css/user.css">
        <link rel="stylesheet" href="/stylesheets/form_popup.css">

        <!-- bootstrap -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
        
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
        
        <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous"> -->
        <link href="http://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
        
        <!-- font poppins -->
        <link href='https://fonts.googleapis.com/css?family=Poppins' rel='stylesheet'>
        <link href="http://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
        
        <!-- icon -->
        <link href="https://cdn.jsdelivr.net/npm/remixicon@2.5.0/fonts/remixicon.css" rel="stylesheet">
        <link rel="stylesheet" href="https://unpkg.com/boxicons@latest/css/boxicons.min.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
        
        <!-- js -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
        <script type="text/javascript" src="api.js"></script>
        <link rel="stylesheet" href="https://unpkg.com/boxicons@latest/css/boxicons.min.css">
        <script src="/html/api.js"></script>

    </head>
    <body>

        <!-- header section starts  -->
        <header>
          <a href="/html/index.html" class="logo">Goods Days <span>.</span></a>

          <nav class="navbar">
              <a href="/html/index.html">home</a>
              <a href="/html/aboutus.html">about</a>
              <a href="/search">search</a>
              <a href="/html/contactus.html">contact</a>
          </nav>

          <div class="icons">
              <a href="/html/login.html" class="fa fa-user"></a>
          </div>
      </header>
      <!-- header section ends -->
      
      <!-- user section start -->
      <section class="user">
        <div class="user-list">
          <h1 class="headus">Admin Account Management</h1>
          
          <!-- Search admin section start -->
          <div class="cen"> <!-- user.css-->
                <h2>Search Administrator</h2>
                <!-- Bootstrap -->
                  <form class="input-group mb-3">
                      <!-- input id firstname and role, not required -->
                      <input type="text" id="id" placeholder="id" name="id"  class="form-control form-control-lg bg-light fs-5">    
                      <input type="text" id="first_name" placeholder="First Name" name="first_name" class="form-control form-control-lg bg-light fs-5">
                      <input type="text" id="role" placeholder="Role" name="role" class="form-control form-control-lg bg-light fs-5">

                      <!-- submit button, directlt go to http://localhost:3000/admins/s , router is in admin.js -->
                      <button type="Search ToT" formaction="/admins/s" formmethod="POST" class="nav-link active">Search Admin</button>
                  </form>    
          </div>
         <!-- Search admin section end -->

        <!-- INSET admin section start -->
        <div class="cen"> <!-- user.css-->
            <!-- bootstrap -->
            <div class="row align-items-center"> 
                  <div class="header-text mb-4">
                    <h2>Insert Admin</h2>
                  </div>
                  <!-- INSERT FORN -->
                  <form>
                    <!-- INSERT ID, First name, Lastname, Role, and email -->
                    <!-- ALL REQUIRED -->
                    <div class="input-group mb-3">
                      <input type="text" id="id" placeholder="id" name="id" class="form-control form-control-lg bg-light fs-5" required><br><br>
                    </div>
                    <div class="input-group mb-3">
                      <input type="text" id="Fname" placeholder="First Name" name="Fname" class="form-control form-control-lg bg-light fs-5" required><br><br>
                    </div>
                    <div class="input-group mb-3">
                      <input type="text" id="Lname" placeholder="Last Name" name="Lname" class="form-control form-control-lg bg-light fs-5" required><br><br>
                    </div>
                    <div class="input-group mb-3">
                      <input type="text" id="Role" placeholder="Owner, Manager, or Admin" name="Role" class="form-control form-control-lg bg-light fs-5" required> <br><br>
                    </div>
                    <div class="input-group mb-3">
                      <input type="email" id="email" placeholder="BoyNextDoor@mail.com" name="email" class="form-control form-control-lg bg-light fs-5" required><br><br>
                    </div>

                    <!-- Submit Button, directly go to http://localhost:3000/admins/add , router is in admins.js-->
                    <div class="row">
                      <button type="submit" formaction="/admins/add" formmethod="POST" class="colorbutton">Add Admin</button><br><br>
                    </div>
                  </form>  
                </div>
        </div>
        <!-- INSERT admin section end -->

        <!-- Admin table section start -->
              <div class="card-body">
                  <% if(data.length) { %>
                     <!-- body admin start-->
                      <table class="table"> <!-- user.css-->
                        <!-- head table -->
                          <thead>
                              <tr>
                                  <th scope="col">#</th>
                                  <th scope="col">firstname</th>
                                  <th scope="col">lastname</th>
                                  <th scope="col">role</th>
                                  <th scope="col">email</th>
                                  <th width="200px">Action</th>
                              </tr>
                          </thead>

                          <!-- body admin start-->
                          <tbody>
                            
                              <!-- loop, data from data:rows http://localhost:3000/admins in admins.ejs -->
                              <% data.forEach( function(d){ %>
                                  <tr>
                                      <th scope="row"><%= d.id %></th>
                                      <td><%= d.first_name %></td>
                                      <td><%= d.last_name %></td>
                                      <td><%= d.role%></td>
                                      <td><%= d.email %></td>

                                      <!-- ACTION start-->
                                      <td>
                                          <%- include('edit_popup.ejs',{curr_id: d.id}) %>
                                          <!-- IGNORE THE ERROR ON OPENFORM(), THIS IS NORMAL -->

                                          <!-- UPDATE ADMIN WITH POPUP FORM, directly go to edit_popup.ejs -->
                                          <a class="btn btn-success edit" 
                                            onclick="openForm(<%=d.id%>)">Edit</a>

                                          <!-- DELETE ADMIN directly go to http://localhost:300/admins/delete -->
                                          <a href="../admins/delete/<%= d.id %>" 
                                            onclick="return alert('Are you sure you want to kill: <%= d.first_name %>')" 
                                            class="btn btn-danger delete">Delete</a>
                                      </td>
                                      <!-- ACTION end-->

                                  </tr>
                              <% }); %>
                          </tbody>
                          <!-- body admin end-->
                      </table>
                  <% } %>
                  <!-- table admin end-->
      
                  <!-- if result is empty -->
                  <% if(!data.length) { %>
                      <p class="text-center">No Admin found!</p>
                  <% } %>

              </div>
              <!-- Admin table section end -->

          </div>
      </section>
      <!-- user section end -->
           
      <!-- footer section starts  -->
      <footer>
        <div class="box-container">
            <div class="box">
                <h3>About Goods Days</h3>
                <a href="/html/index.html">Home</a>
                <a href="/html/aboutus.html">About</a>
                <a href="/search">Search</a>
                <a href="/html/login.html">Log-in</a>
                <a href="/html/signup.html">Sign-up</a>
                <a href="/html/contactus.html">Contact Us</a>
            </div>

            <div class="box">
                <h3 class="fa fa-user-secret"></h3>
                <a href="/">Admin Log-in</a>
                <a href="/admins">User management</a>

            </div>

            <div class="box">
              <script> 
                  // His function is triggered when the search button is clicked, and it retrieves data from the Anime News Network API
                  function getConferenceResponses() {
                      let query = document.querySelector("#q").value; // Get query from a textbox
                      console.log(query);
                      let rooturl = "https://cdn.animenewsnetwork.com/encyclopedia/api.xml?title=~" + query; //Request URL
                      fetch(rooturl)
                          .then(res => res.text()) // Get JSON from the response
                          // .then(str => new window.DOMParser().parseFromString(str, "text/xml"))
                          .then((data) => {
                              //console.log(data)
                              let objson = xml2json.fromStr(data);
                              console.log(objson);
                              for (let i = 0; i < objson.ann.anime.length; i++) {
                                  let title = objson.ann.anime[i]['@attributes'].name;
                                  let precision = objson.ann.anime[i]['@attributes'].precision;

                                  document.querySelector("#output").innerHTML += "<p>Name : " + title + "</p>" + "<p>Precision :" + precision + "</p><br>";
                              }
                          })
                          .catch((err) => console.log(err));
                  }
              </script>

              <h2>News Anime</h2>
              <input type="text" placeholder="anime" id="q">
      
              <button onclick="getConferenceResponses()"><i class="ri-search-line"></i></button>
      
              <p>Anime</p>
              <div id="output"></div>
          </div>
        </div>
      </footer>
      <!-- footer section ends -->

      <!-- script for update admin pop up -->
      <script>
        function openForm(a) {
          document.getElementById("popupForm"+a).style.display = "block";
        }
        function closeForm(a) {
          document.getElementById("popupForm"+a).style.display = "none";
        }
      </script>
   </body>
</html>


